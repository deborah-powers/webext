<!DOCTYPE html><html><head>
	<title></title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='_blank'>
<style type='text/css'>
	h2 { width: 100%; }
	div {
		border: none;
		background-color: #FEE;
		width: 50%;
		height: 4em;
		display: inline-block;
		margin: 0;
	}
	section {
		display: grid;
		grid-template-rows: 2em 1fr 1fr;
		grid-template-columns: 1fr 1fr;
		grid-auto-flow: column;
	}
	h2 { grid-column: 1/4; }
	section#contrast {
		grid-template-columns: 1fr 1fr 1fr;
		grid-auto-flow: row;
	}
	input {
		width: 100%;
		height: 100%;
		border-radius: 0;
		margin: 0;
	}
	/*
	input[type='color'] {
		border: none;
		border-color: transparent;
		appearance: none;
		-moz-appearance: none;
		-o-appearance: none;
		-webkit-appearance: none;
	}
	input[type='color']::-moz-color-swatch {
		border: none;
	}
	input[type='color']::-webkit-color-swatch-wrapper {
		padding: 0;
		border-radius: 0;
	}
	input[type='color']::-webkit-color-swatch { border: none; }
	*/
</style></head><body>
	<div id='col-a-block'></div><div id='col-o-block'></div>
	<section>
		<h2>entrez la première couleur</h2>
		<p>choisir:</p><input type='color' id='col-a-picker' onchange='pickColor("col-a",this.value)' />
		<p>code couleur:</p><input type='text' id='col-a-code' onchange='pickColor("col-a",this.value)' />
	</section>
	<section>
		<h2>entrez la seconde couleur</h2>
		<p>choisir:</p><input type='color' id='col-o-picker' onchange='pickColor("col-o",this.value)' />
		<p>code couleur:</p><input type='text' id='col-o-code' onchange='pickColor("col-o",this.value)' />
	</section>
	<section id='contrast'>
		<h2>qualité du contraste: $contrast:1</h2>
		<p>.</p><p>AA</p><p>AAA</p>
		<p>grand texte (>18pt)</p><p>$grandTextAA</p><p>$grandTextAAA</p>
		<p>petit texte (>14pt) ou gras</p><p>$petitTextAA</p><p>$petitTextAAA</p>
	</section>
</body><script type='text/javascript'>
	const contrastBlock ="<h2>qualité du contraste: $contrast:1</h2><p>.</p><p>AA</p><p>AAA</p><p>grand texte (>18pt)</p><p>$grandTextAA</p><p>$grandTextAAA</p><p>petit texte (>14pt) ou gras</p><p>$petitTextAA</p><p>$petitTextAAA</p>";
	function computefromSrgb (colSrgb){
		var color =0;
		if (colSrgb > 0.03928){
			color = colSrgb + 0.055;
			color /= 1.055;
			color = color **2.4;
		}
		else color = colSrgb / 12.92;
		return color;
	}
	function luxFromHex (hexCode){
		const hexArray = [ hexCode[1] + hexCode[2], hexCode[3] + hexCode[4], hexCode[5] + hexCode[6] ];
		var rs = parseInt (hexArray[0], 16);
		rs /= 255.0;
		var gs = parseInt (hexArray[1], 16);
		gs /= 255.0;
		var bs = parseInt (hexArray[2], 16);
		bs /= 255.0;
		const lux = 0.2126 * computefromSrgb (rs) + 0.7152 * computefromSrgb (gs) + 0.0722 * computefromSrgb (bs);
		return lux;
	}
	function contrastFromHex (hexa, hexo){
		const luxa = luxFromHex (hexa);
		const luxo = luxFromHex (hexo);
		if (luxa > luxo) return (luxa + 0.05) / (luxo + 0.05);
		else return (luxo + 0.05) / (luxa + 0.05);
	}
	function contrastOk (color, color2){
		var lux = contrastFromHex (color, color2);
		lux = Math.round (lux * 10) /10;
		const sectionConstast = document.getElementById ('contrast');
		sectionConstast.innerHTML = contrastBlock.replace ('$contrast', lux);
		if (lux <3){
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAA', 'KO');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAAA', 'KO');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAA', 'KO');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAAA', 'KO');
		}
		else if (lux <4.5){
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAAA', 'KO');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAA', 'KO');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAAA', 'KO');
		}
		else if (lux <7){
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAAA', 'KO');
		}
		else{
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$grandTextAAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAA', 'OK');
			sectionConstast.innerHTML = sectionConstast.innerHTML.replace ('$petitTextAAA', 'OK');
		}
	}
	function pickColor (blocId, color){
		// valider la couleur
		if (color[0] !== '#') color = '#'+ color;
		if (color.length <4 || color.length >9 || color.length ===6 || color.length ===8) color = '#FEE';
		else{
			color = color.toUpperCase();
			const values = '0123456789ABCDEF';
			var colorOk = true;
			var c=1;
			while (c< color.length && colorOk){
				if (! values.includes (color[c])) colorOk = false;
				c+=1;
			}
			if (! colorOk) color = '#FFEEEE';
			else if (color.length ===4) color = '#'+ color[1] + color[1] + color[2] + color[2] + color[3] + color[3];
		}
		// afficher la couleur
		document.getElementById (blocId +'-block').style.backgroundColor = color;
		document.getElementById (blocId +'-picker').value = color;
		document.getElementById (blocId +'-code').value = color;
		// comparer les couleurs
		var color2 = color;
		if (blocId === 'col-a') color2 = document.getElementById ('col-o-picker').value;
		else color2 = document.getElementById ('col-a-picker').value;
		contrastOk (color, color2);
	}
	// pour les jeux de mots: ABCDEFGILOS
	pickColor ('col-a', '01AFEE');
	pickColor ('col-o', 'CEFADA');
</script></html>